{"ast":null,"code":"var _jsxFileName = \"/Users/kollusaimanaswi/Desktop/intel_avatars/facial-animation/src/components/View.js\";\nimport React, { Component } from \"react\";\nimport \"./css/View.css\";\nimport Model from \"./Model.js\";\nimport AudioRecorder from \"./AudioRecorder.js\";\nimport \"./css/Slider.css\";\nimport \"./css/Toggle.css\";\nimport \"./css/Progress.css\";\nimport { Transition } from \"react-transition-group\";\nimport { login, authFetch, useAuth, logout } from \"../auth\";\nimport { AUDIO_FRAME, FPS, transitionStyles, defaultStyle, defaultStyleMount, darkBg, darkFont, darkFocus, lightBg, lightFont, lightFocus, darkBack1, darkBack2, lightBack1, lightBack2 } from \"../Config.js\";\n\nclass View extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      file: undefined,\n      animationStatus: \"STOP\",\n      visemes: undefined,\n      inputProcessed: false,\n      sliderValue: 0.55,\n      popup: false,\n      mounted: false,\n      popupText: \"\",\n      menu: false,\n      progress: 0\n    }; // this.theme = this.props.theme;\n\n    this.theme = \"light\";\n    this.themeSlider = React.createRef();\n    this.move = 0.02;\n    this.delta = 0;\n    this.modelControlActive = false;\n    this.currentFrame = 0;\n    this.lidMove = 0.1;\n    this.lidSpeed = 0.1;\n    this.lidWait = 1;\n    this.play = this.play.bind(this);\n    this.pause = this.pause.bind(this);\n    this.stop = this.stop.bind(this);\n    this.processResponse = this.processResponse.bind(this);\n    this.fetchInput = this.fetchInput.bind(this);\n    this.playAnimation = this.playAnimation.bind(this);\n    this.pauseAnimation = this.pauseAnimation.bind(this);\n    this.stopAnimation = this.stopAnimation.bind(this);\n    this.handleFile = this.handleFile.bind(this);\n    this.sendFile = this.sendFile.bind(this);\n    this.handleSlider = this.handleSlider.bind(this);\n    this.handleRecording = this.handleRecording.bind(this);\n    this.openPopup = this.openPopup.bind(this);\n    this.closePopup = this.closePopup.bind(this);\n    this.modelLoaded = this.modelLoaded.bind(this);\n    this.setTheme = this.setTheme.bind(this);\n    this.themeHandler = this.themeHandler.bind(this);\n    this.showMenu = this.showMenu.bind(this);\n    this.setProgress = this.setProgress.bind(this);\n  }\n\n  componentDidMount() {\n    this.fetchInput();\n    if (this.theme === \"light\" && this.themeSlider.current) this.themeSlider.current.checked = true;\n    this.setTheme(this.theme);\n    this.audio = new Audio();\n    this.audio.loop = false;\n  }\n\n  componentDidUpdate() {}\n\n  fetchInput() {\n    // test server fetch\n    fetch(\"/api/time\").then(res => res.json()).then(data => {\n      console.log(data);\n    });\n  }\n\n  calculateDistance(point1, point2) {\n    return Math.sqrt(Math.pow(point1[0] - point2[0], 2) + Math.pow(point1[1] - point2[1], 2));\n  }\n\n  processResponse(response) {\n    // process the viseme list from the server\n    const step = 1000 / AUDIO_FRAME / FPS;\n    var result = [],\n        frame = undefined,\n        j = undefined;\n\n    for (var i = 0; i < response.length; i += step) {\n      // change the frequency of the visemes from 100Hz to 60Hz\n      frame = response.slice(i, i + step)[0];\n      result.push(frame);\n      j = result.length - 1;\n\n      if (j >= 3) {\n        // eliminate singular visemes\n        if (result[j - 2] !== result[j - 1] && result[j - 1] !== result[j]) {\n          result[result.length - 2] = result[result.length - 3];\n        }\n      }\n    }\n\n    this.setState({\n      visemes: result,\n      inputProcessed: true\n    });\n  }\n\n  maxElement(array) {\n    if (array.length === 0) return null;\n    var modeMap = {};\n    var maxEl = array[0],\n        maxCount = 1;\n\n    for (var i = 0; i < array.length; i++) {\n      var el = array[i];\n      if (modeMap[el] == null) modeMap[el] = 1;else modeMap[el]++;\n\n      if (modeMap[el] > maxCount) {\n        maxEl = el;\n        maxCount = modeMap[el];\n      }\n    }\n\n    return maxEl;\n  }\n\n  stop() {\n    // stops the audio file and corresponding animation\n    if (this.state.animationStatus === \"PLAY\" || this.state.animationStatus === \"PAUSE\") {\n      this.audio.pause();\n      this.audio.currentTime = 0;\n      this.setState({\n        animationStatus: \"STOP\"\n      });\n    }\n  }\n\n  play() {\n    // plays the audio file and corresponding animation\n    if (this.state.animationStatus === \"STOP\" || this.state.animationStatus === \"PAUSE\") {\n      this.audio.play();\n      this.setState({\n        animationStatus: \"PLAY\"\n      });\n    }\n  }\n\n  pause() {\n    // pauses the audio file and corresponding animation\n    if (this.state.animationStatus === \"PLAY\") {\n      this.audio.pause();\n      this.setState({\n        animationStatus: \"PAUSE\"\n      });\n    }\n  }\n\n  playAnimation() {\n    // handler for Play button\n    if (!this.state.inputProcessed) {\n      this.openPopup(\"Upload the audio file to the server!\");\n    } else {\n      this.play();\n    }\n  }\n\n  stopAnimation() {\n    // handler for Stop button\n    if (!this.state.inputProcessed) {\n      this.openPopup(\"Upload the audio file to the server!\");\n    } else {\n      this.stop();\n    }\n  }\n\n  pauseAnimation() {\n    // handler for Pause button\n    if (!this.state.inputProcessed) {\n      this.openPopup(\"Upload the audio file to the server!\");\n    } else {\n      this.pause();\n    }\n  }\n\n  handleFile(event) {\n    // registers the newly uploaded file\n    if (event.target.files.length > 0) {\n      var fileData = event.target.files[0];\n      var fileSource = URL.createObjectURL(fileData);\n      this.stop();\n      this.setState({\n        file: fileData,\n        inputProcessed: false,\n        filename: fileData.name\n      });\n      this.audio.src = fileSource;\n    }\n  }\n\n  handleRecording(recording) {\n    // registers the newly recorded file\n    this.stop();\n    this.setState({\n      file: recording,\n      inputProcessed: false,\n      filename: \"Recording\"\n    });\n    this.audio.src = URL.createObjectURL(recording);\n    console.log(this.state.file, this.audio.src);\n  }\n\n  async sendFile() {\n    // send the request to the server with the current audio file\n    if (this.state.file) {\n      // prepare audio file for request\n      const data = new FormData();\n      data.append(\"file\", this.state.file);\n      this.setState({\n        inputProcessed: undefined\n      });\n      this.stop(); // authenticated fetch by JWT\n\n      authFetch(\"http://localhost:5001/api/upload\", {\n        method: \"POST\",\n        body: data\n      }) // handle the response\n      .then(res => {\n        if (res.status === 401) {\n          this.setState({\n            inputProcessed: false\n          });\n          this.openPopup(\"Sorry you aren't authorized!\");\n          return null;\n        } else if (res.status !== 200) {\n          this.setState({\n            inputProcessed: false\n          });\n          this.openPopup(\"Server failure!\");\n          return null;\n        }\n\n        return res.json();\n      }).then(res => {\n        if (res) {\n          if (res.status === 200) {\n            this.processResponse(res.result);\n          } else if (res.message === \"Extension\") {\n            this.setState({\n              inputProcessed: false\n            });\n            this.openPopup(\"Incorrect extension! Upload .wav and .mp3 files.\");\n          } else if (res.message === \"Model\") {\n            this.setState({\n              inputProcessed: false\n            });\n            this.openPopup(\"Model failure!\");\n          }\n        }\n      });\n    } else {\n      this.openPopup(\"Choose a file!\");\n    }\n  }\n\n  mapSliderValue(x) {\n    return 0.5 + 0.5 * x;\n  }\n\n  handleSlider(event) {\n    this.setState({\n      sliderValue: event.target.value\n    });\n  }\n\n  showMenu() {\n    // toggle the menu view\n    this.setState({\n      menu: !this.state.menu\n    }, () => {\n      if (this.state.menu) {\n        if (this.theme === \"light\" && this.themeSlider.current) this.themeSlider.current.checked = true;else if (this.theme === \"dark\" && this.themeSlider.current) {\n          this.themeSlider.current.checked = false;\n        }\n      }\n    });\n  }\n\n  openPopup(text) {\n    this.setState({\n      popup: true,\n      popupText: text\n    });\n  }\n\n  closePopup() {\n    this.setState({\n      popup: false,\n      popupText: \"\"\n    });\n  }\n\n  modelLoaded() {\n    this.setState({\n      mounted: true\n    });\n  }\n\n  themeHandler(e) {\n    if (e.target.checked) this.setTheme(\"light\");else this.setTheme(\"dark\");\n  }\n\n  setProgress(p) {\n    this.setState({\n      progress: p\n    });\n  }\n\n  setTheme(newTheme) {\n    // set the colors corresponding to the current theme\n    if (newTheme !== this.theme) {\n      this.theme = newTheme;\n    }\n\n    this.props.setTheme(this.theme);\n\n    if (this.theme === \"light\") {\n      document.body.style.setProperty(\"--primary\", lightBg);\n      document.body.style.setProperty(\"--secondary\", lightFont);\n      document.body.style.setProperty(\"--focus\", lightFocus);\n      document.body.style.setProperty(\"--back1\", lightBack1);\n      document.body.style.setProperty(\"--back2\", lightBack2);\n    } else {\n      document.body.style.setProperty(\"--primary\", darkBg);\n      document.body.style.setProperty(\"--secondary\", darkFont);\n      document.body.style.setProperty(\"--focus\", darkFocus);\n      document.body.style.setProperty(\"--back1\", darkBack1);\n      document.body.style.setProperty(\"--back2\", darkBack2);\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(Transition, {\n      timeout: 500,\n      in: this.state.mounted,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 363,\n        columnNumber: 7\n      }\n    }, state => /*#__PURE__*/React.createElement(\"div\", {\n      style: { ...defaultStyleMount,\n        ...transitionStyles[state]\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 365,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"view-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 371,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Transition, {\n      timeout: 300,\n      in: this.state.popup,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 372,\n        columnNumber: 15\n      }\n    }, state => /*#__PURE__*/React.createElement(\"div\", {\n      style: { ...defaultStyle,\n        ...transitionStyles[state]\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 374,\n        columnNumber: 19\n      }\n    }, this.state.popup && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"background\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 381,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"popup\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 382,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"popup-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 383,\n        columnNumber: 27\n      }\n    }, this.state.popupText), /*#__PURE__*/React.createElement(\"button\", {\n      id: \"popup-close\",\n      className: \"styled-button\",\n      onClick: this.closePopup,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 384,\n        columnNumber: 27\n      }\n    }, \"X\"))))), /*#__PURE__*/React.createElement(Transition, {\n      timeout: 300,\n      in: this.state.inputProcessed === undefined,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 398,\n        columnNumber: 15\n      }\n    }, state => /*#__PURE__*/React.createElement(\"div\", {\n      style: { ...defaultStyle,\n        ...transitionStyles[state]\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 403,\n        columnNumber: 19\n      }\n    }, this.state.inputProcessed === undefined && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"background\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 410,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"loader\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 411,\n        columnNumber: 25\n      }\n    })))), /*#__PURE__*/React.createElement(Transition, {\n      timeout: 300,\n      in: this.state.infoPopup,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 418,\n        columnNumber: 15\n      }\n    }, state => /*#__PURE__*/React.createElement(\"div\", {\n      style: { ...defaultStyle,\n        ...transitionStyles[state]\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 420,\n        columnNumber: 19\n      }\n    }, this.state.infoPopup && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"background\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 427,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"popup\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 428,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"info-head\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 429,\n        columnNumber: 27\n      }\n    }, \"Audio-driven facial animation\"), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"info-authors\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 432,\n        columnNumber: 27\n      }\n    }, \"Authors: Ma\\u0142gorzata Nowicka, Filip Zawadka\"), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"info-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 435,\n        columnNumber: 27\n      }\n    }, \"This application is a realization of the author's Bachelor's thesis project at the Warsaw University of Technology. It generates animation for given speech recording. The application integrates the trained long short-term memory neural network model, residing on the remote server.\"), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"info-inst-head\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 443,\n        columnNumber: 27\n      }\n    }, \"Instruction:\"), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"info-inst\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 444,\n        columnNumber: 27\n      }\n    }, \"Press the icon in the top-left corner to display the menu.\"), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"info-inst\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 448,\n        columnNumber: 27\n      }\n    }, \"Press \", /*#__PURE__*/React.createElement(\"b\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 449,\n        columnNumber: 35\n      }\n    }, \"Choose file\"), \" to upload a \", /*#__PURE__*/React.createElement(\"b\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 449,\n        columnNumber: 66\n      }\n    }, \"wav\"), \" or\", \" \", /*#__PURE__*/React.createElement(\"b\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 450,\n        columnNumber: 29\n      }\n    }, \"mp3\"), \" audio file with speech. Press\", \" \", /*#__PURE__*/React.createElement(\"b\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 451,\n        columnNumber: 29\n      }\n    }, \"Record\"), \" to record the speech in real-time.\"), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"info-inst\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 453,\n        columnNumber: 27\n      }\n    }, \"Press \", /*#__PURE__*/React.createElement(\"b\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 454,\n        columnNumber: 35\n      }\n    }, \"Upload\"), \" to send the speech recording to the server.\"), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"info-inst\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 457,\n        columnNumber: 27\n      }\n    }, \"When the model is performing the computations on the server, a loading spinner is displayed. Wait until it disappears.\"), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"info-inst\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 462,\n        columnNumber: 27\n      }\n    }, \"The \", /*#__PURE__*/React.createElement(\"b\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 463,\n        columnNumber: 33\n      }\n    }, \"player\"), \" options in the bottom-left corner handle the animation. Change the intensity of the avatar's expression with the \", /*#__PURE__*/React.createElement(\"b\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 465,\n        columnNumber: 58\n      }\n    }, \"slider\"), \".\"), /*#__PURE__*/React.createElement(\"button\", {\n      id: \"popup-close\",\n      className: \"styled-button\",\n      onClick: e => this.setState({\n        infoPopup: false\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 467,\n        columnNumber: 27\n      }\n    }, \"X\"))))), /*#__PURE__*/React.createElement(\"button\", {\n      id: \"info-button\",\n      className: \"styled-button\",\n      onClick: e => this.setState({\n        infoPopup: true\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 481,\n        columnNumber: 15\n      }\n    }, \"\\u24D8\"), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"menu-icon\",\n      onClick: this.showMenu,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 496,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"menu-bar\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 497,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"menu-bar\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 498,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"menu-bar\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 499,\n        columnNumber: 17\n      }\n    })), /*#__PURE__*/React.createElement(Transition, {\n      timeout: 300,\n      in: this.state.menu,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 502,\n        columnNumber: 15\n      }\n    }, state => /*#__PURE__*/React.createElement(\"div\", {\n      style: { ...defaultStyle,\n        ...transitionStyles[state]\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 504,\n        columnNumber: 19\n      }\n    }, this.state.menu && /*#__PURE__*/React.createElement(\"div\", {\n      id: \"main-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 511,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      id: \"choose-file\",\n      className: \"horizontal vert\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 523,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"styled-button-file-input\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 524,\n        columnNumber: 27\n      }\n    }, \"Choose file\"), /*#__PURE__*/React.createElement(\"input\", {\n      id: \"choose-file\",\n      type: \"file\",\n      accept: \"audio/wav, audio/mp3\",\n      onChange: this.handleFile,\n      multiple: false,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 525,\n        columnNumber: 27\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"chosen-file\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 533,\n        columnNumber: 25\n      }\n    }, this.state.filename), /*#__PURE__*/React.createElement(\"button\", {\n      id: \"upload-button\",\n      className: \"styled-button narrow\",\n      onClick: this.sendFile,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 534,\n        columnNumber: 25\n      }\n    }, \"Upload\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"bottom horizontal\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 541,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      id: \"play\",\n      className: \"player styled-button\",\n      onClick: this.playAnimation,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 542,\n        columnNumber: 27\n      }\n    }, \"Play\"), /*#__PURE__*/React.createElement(\"button\", {\n      id: \"pause\",\n      className: \"player styled-button\",\n      onClick: this.pauseAnimation,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 549,\n        columnNumber: 27\n      }\n    }, \"Pause\"), /*#__PURE__*/React.createElement(\"button\", {\n      id: \"stop\",\n      className: \"player styled-button\",\n      onClick: this.stopAnimation,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 556,\n        columnNumber: 27\n      }\n    }, \"Stop\"))))), /*#__PURE__*/React.createElement(Model, {\n      id: \"model\",\n      animationStatus: this.state.animationStatus,\n      visemes: this.state.visemes,\n      sliderValue: this.mapSliderValue(this.state.sliderValue),\n      mounted: this.modelLoaded,\n      theme: this.theme,\n      setProgress: this.setProgress,\n      audio: this.audio,\n      stopAnimation: this.stopAnimation,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 596,\n        columnNumber: 15\n      }\n    }))));\n  }\n\n}\n\nexport default View;","map":{"version":3,"sources":["/Users/kollusaimanaswi/Desktop/intel_avatars/facial-animation/src/components/View.js"],"names":["React","Component","Model","AudioRecorder","Transition","login","authFetch","useAuth","logout","AUDIO_FRAME","FPS","transitionStyles","defaultStyle","defaultStyleMount","darkBg","darkFont","darkFocus","lightBg","lightFont","lightFocus","darkBack1","darkBack2","lightBack1","lightBack2","View","constructor","props","state","file","undefined","animationStatus","visemes","inputProcessed","sliderValue","popup","mounted","popupText","menu","progress","theme","themeSlider","createRef","move","delta","modelControlActive","currentFrame","lidMove","lidSpeed","lidWait","play","bind","pause","stop","processResponse","fetchInput","playAnimation","pauseAnimation","stopAnimation","handleFile","sendFile","handleSlider","handleRecording","openPopup","closePopup","modelLoaded","setTheme","themeHandler","showMenu","setProgress","componentDidMount","current","checked","audio","Audio","loop","componentDidUpdate","fetch","then","res","json","data","console","log","calculateDistance","point1","point2","Math","sqrt","pow","response","step","result","frame","j","i","length","slice","push","setState","maxElement","array","modeMap","maxEl","maxCount","el","currentTime","event","target","files","fileData","fileSource","URL","createObjectURL","filename","name","src","recording","FormData","append","method","body","status","message","mapSliderValue","x","value","text","e","p","newTheme","document","style","setProperty","render","infoPopup"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport \"./css/View.css\";\nimport Model from \"./Model.js\";\nimport AudioRecorder from \"./AudioRecorder.js\";\nimport \"./css/Slider.css\";\nimport \"./css/Toggle.css\";\nimport \"./css/Progress.css\";\nimport { Transition } from \"react-transition-group\";\nimport { login, authFetch, useAuth, logout } from \"../auth\";\nimport {\n  AUDIO_FRAME,\n  FPS,\n  transitionStyles,\n  defaultStyle,\n  defaultStyleMount,\n  darkBg,\n  darkFont,\n  darkFocus,\n  lightBg,\n  lightFont,\n  lightFocus,\n  darkBack1,\n  darkBack2,\n  lightBack1,\n  lightBack2,\n} from \"../Config.js\";\n\nclass View extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      file: undefined,\n      animationStatus: \"STOP\",\n      visemes: undefined,\n      inputProcessed: false,\n      sliderValue: 0.55,\n      popup: false,\n      mounted: false,\n      popupText: \"\",\n      menu: false,\n      progress: 0,\n    };\n\n    // this.theme = this.props.theme;\n    this.theme = \"light\";\n    this.themeSlider = React.createRef();\n\n    this.move = 0.02;\n    this.delta = 0;\n\n    this.modelControlActive = false;\n\n    this.currentFrame = 0;\n\n    this.lidMove = 0.1;\n    this.lidSpeed = 0.1;\n    this.lidWait = 1;\n\n    this.play = this.play.bind(this);\n    this.pause = this.pause.bind(this);\n    this.stop = this.stop.bind(this);\n    this.processResponse = this.processResponse.bind(this);\n    this.fetchInput = this.fetchInput.bind(this);\n    this.playAnimation = this.playAnimation.bind(this);\n    this.pauseAnimation = this.pauseAnimation.bind(this);\n    this.stopAnimation = this.stopAnimation.bind(this);\n    this.handleFile = this.handleFile.bind(this);\n    this.sendFile = this.sendFile.bind(this);\n    this.handleSlider = this.handleSlider.bind(this);\n    this.handleRecording = this.handleRecording.bind(this);\n    this.openPopup = this.openPopup.bind(this);\n    this.closePopup = this.closePopup.bind(this);\n    this.modelLoaded = this.modelLoaded.bind(this);\n    this.setTheme = this.setTheme.bind(this);\n    this.themeHandler = this.themeHandler.bind(this);\n    this.showMenu = this.showMenu.bind(this);\n    this.setProgress = this.setProgress.bind(this);\n  }\n\n  componentDidMount() {\n    this.fetchInput();\n\n    if (this.theme === \"light\" && this.themeSlider.current)\n      this.themeSlider.current.checked = true;\n    this.setTheme(this.theme);\n    this.audio = new Audio();\n    this.audio.loop = false;\n  }\n\n  componentDidUpdate() { }\n\n  fetchInput() {\n    // test server fetch\n    fetch(\"/api/time\")\n      .then((res) => res.json())\n      .then((data) => {\n        console.log(data);\n      });\n  }\n\n  calculateDistance(point1, point2) {\n    return Math.sqrt(\n      Math.pow(point1[0] - point2[0], 2) + Math.pow(point1[1] - point2[1], 2)\n    );\n  }\n\n  processResponse(response) {\n    // process the viseme list from the server\n    const step = 1000 / AUDIO_FRAME / FPS;\n    var result = [],\n      frame = undefined,\n      j = undefined;\n    for (var i = 0; i < response.length; i += step) {\n      // change the frequency of the visemes from 100Hz to 60Hz\n      frame = response.slice(i, i + step)[0];\n      result.push(frame);\n\n      j = result.length - 1;\n      if (j >= 3) {\n        // eliminate singular visemes\n        if (result[j - 2] !== result[j - 1] && result[j - 1] !== result[j]) {\n          result[result.length - 2] = result[result.length - 3];\n        }\n      }\n    }\n    this.setState({\n      visemes: result,\n      inputProcessed: true,\n    });\n  }\n\n  maxElement(array) {\n    if (array.length === 0) return null;\n    var modeMap = {};\n    var maxEl = array[0],\n      maxCount = 1;\n    for (var i = 0; i < array.length; i++) {\n      var el = array[i];\n      if (modeMap[el] == null) modeMap[el] = 1;\n      else modeMap[el]++;\n      if (modeMap[el] > maxCount) {\n        maxEl = el;\n        maxCount = modeMap[el];\n      }\n    }\n    return maxEl;\n  }\n\n  stop() {\n    // stops the audio file and corresponding animation\n    if (\n      this.state.animationStatus === \"PLAY\" ||\n      this.state.animationStatus === \"PAUSE\"\n    ) {\n      this.audio.pause();\n      this.audio.currentTime = 0;\n      this.setState({ animationStatus: \"STOP\" });\n    }\n  }\n\n  play() {\n    // plays the audio file and corresponding animation\n    if (\n      this.state.animationStatus === \"STOP\" ||\n      this.state.animationStatus === \"PAUSE\"\n    ) {\n      this.audio.play();\n      this.setState({ animationStatus: \"PLAY\" });\n    }\n  }\n\n  pause() {\n    // pauses the audio file and corresponding animation\n    if (this.state.animationStatus === \"PLAY\") {\n      this.audio.pause();\n      this.setState({ animationStatus: \"PAUSE\" });\n    }\n  }\n\n  playAnimation() {\n    // handler for Play button\n    if (!this.state.inputProcessed) {\n      this.openPopup(\"Upload the audio file to the server!\");\n    } else {\n      this.play();\n    }\n  }\n\n  stopAnimation() {\n    // handler for Stop button\n    if (!this.state.inputProcessed) {\n      this.openPopup(\"Upload the audio file to the server!\");\n    } else {\n      this.stop();\n    }\n  }\n\n  pauseAnimation() {\n    // handler for Pause button\n    if (!this.state.inputProcessed) {\n      this.openPopup(\"Upload the audio file to the server!\");\n    } else {\n      this.pause();\n    }\n  }\n\n  handleFile(event) {\n    // registers the newly uploaded file\n    if (event.target.files.length > 0) {\n      var fileData = event.target.files[0];\n      var fileSource = URL.createObjectURL(fileData);\n\n      this.stop();\n      this.setState({\n        file: fileData,\n        inputProcessed: false,\n        filename: fileData.name,\n      });\n      this.audio.src = fileSource;\n    }\n  }\n\n  handleRecording(recording) {\n    // registers the newly recorded file\n    this.stop();\n    this.setState({\n      file: recording,\n      inputProcessed: false,\n      filename: \"Recording\",\n    });\n    this.audio.src = URL.createObjectURL(recording);\n\n    console.log(this.state.file, this.audio.src);\n  }\n\n  async sendFile() {\n    // send the request to the server with the current audio file\n    if (this.state.file) {\n      // prepare audio file for request\n      const data = new FormData();\n      data.append(\"file\", this.state.file);\n\n      this.setState({ inputProcessed: undefined });\n      this.stop();\n\n      // authenticated fetch by JWT\n      authFetch(\"http://localhost:5001/api/upload\", { method: \"POST\", body: data })\n        // handle the response\n        .then((res) => {\n          if (res.status === 401) {\n            this.setState({ inputProcessed: false });\n            this.openPopup(\"Sorry you aren't authorized!\");\n            return null;\n          } else if (res.status !== 200) {\n            this.setState({ inputProcessed: false });\n            this.openPopup(\"Server failure!\");\n            return null;\n          }\n          return res.json();\n        })\n        .then((res) => {\n          if (res) {\n            if (res.status === 200) {\n              this.processResponse(res.result);\n            } else if (res.message === \"Extension\") {\n              this.setState({ inputProcessed: false });\n              this.openPopup(\n                \"Incorrect extension! Upload .wav and .mp3 files.\"\n              );\n            } else if (res.message === \"Model\") {\n              this.setState({ inputProcessed: false });\n              this.openPopup(\"Model failure!\");\n            }\n          }\n        });\n    } else {\n      this.openPopup(\"Choose a file!\");\n    }\n  }\n\n  mapSliderValue(x) {\n    return 0.5 + 0.5 * x;\n  }\n\n  handleSlider(event) {\n    this.setState({\n      sliderValue: event.target.value,\n    });\n  }\n\n  showMenu() {\n    // toggle the menu view\n    this.setState(\n      {\n        menu: !this.state.menu,\n      },\n      () => {\n        if (this.state.menu) {\n          if (this.theme === \"light\" && this.themeSlider.current)\n            this.themeSlider.current.checked = true;\n          else if (this.theme === \"dark\" && this.themeSlider.current) {\n            this.themeSlider.current.checked = false;\n          }\n        }\n      }\n    );\n  }\n\n  openPopup(text) {\n    this.setState({\n      popup: true,\n      popupText: text,\n    });\n  }\n\n  closePopup() {\n    this.setState({\n      popup: false,\n      popupText: \"\",\n    });\n  }\n\n  modelLoaded() {\n    this.setState({\n      mounted: true,\n    });\n  }\n\n  themeHandler(e) {\n    if (e.target.checked) this.setTheme(\"light\");\n    else this.setTheme(\"dark\");\n  }\n\n  setProgress(p) {\n    this.setState({\n      progress: p,\n    });\n  }\n\n  setTheme(newTheme) {\n    // set the colors corresponding to the current theme\n    if (newTheme !== this.theme) {\n      this.theme = newTheme;\n    }\n    this.props.setTheme(this.theme);\n    if (this.theme === \"light\") {\n      document.body.style.setProperty(\"--primary\", lightBg);\n      document.body.style.setProperty(\"--secondary\", lightFont);\n      document.body.style.setProperty(\"--focus\", lightFocus);\n      document.body.style.setProperty(\"--back1\", lightBack1);\n      document.body.style.setProperty(\"--back2\", lightBack2);\n    } else {\n      document.body.style.setProperty(\"--primary\", darkBg);\n      document.body.style.setProperty(\"--secondary\", darkFont);\n      document.body.style.setProperty(\"--focus\", darkFocus);\n      document.body.style.setProperty(\"--back1\", darkBack1);\n      document.body.style.setProperty(\"--back2\", darkBack2);\n    }\n  }\n\n  render() {\n    return (\n      <Transition timeout={500} in={this.state.mounted}>\n        {(state) => (\n          <div\n            style={{\n              ...defaultStyleMount,\n              ...transitionStyles[state],\n            }}\n          >\n            <div id=\"view-container\">\n              <Transition timeout={300} in={this.state.popup}>\n                {(state) => (\n                  <div\n                    style={{\n                      ...defaultStyle,\n                      ...transitionStyles[state],\n                    }}\n                  >\n                    {this.state.popup && (\n                      <div className=\"background\">\n                        <div className=\"popup\">\n                          <div id=\"popup-text\">{this.state.popupText}</div>\n                          <button\n                            id=\"popup-close\"\n                            className=\"styled-button\"\n                            onClick={this.closePopup}\n                          >\n                            X\n                          </button>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                )}\n              </Transition>\n\n              <Transition\n                timeout={300}\n                in={this.state.inputProcessed === undefined}\n              >\n                {(state) => (\n                  <div\n                    style={{\n                      ...defaultStyle,\n                      ...transitionStyles[state],\n                    }}\n                  >\n                    {this.state.inputProcessed === undefined && (\n                      <div className=\"background\">\n                        <div className=\"loader\"></div>\n                      </div>\n                    )}\n                  </div>\n                )}\n              </Transition>\n\n              <Transition timeout={300} in={this.state.infoPopup}>\n                {(state) => (\n                  <div\n                    style={{\n                      ...defaultStyle,\n                      ...transitionStyles[state],\n                    }}\n                  >\n                    {this.state.infoPopup && (\n                      <div className=\"background\">\n                        <div className=\"popup\">\n                          <div id=\"info-head\">\n                            Audio-driven facial animation\n                          </div>\n                          <div id=\"info-authors\">\n                            Authors: Magorzata Nowicka, Filip Zawadka\n                          </div>\n                          <div id=\"info-text\">\n                            This application is a realization of the author's\n                            Bachelor's thesis project at the Warsaw University\n                            of Technology. It generates animation for given\n                            speech recording. The application integrates the\n                            trained long short-term memory neural network model,\n                            residing on the remote server.\n                          </div>\n                          <div id=\"info-inst-head\">Instruction:</div>\n                          <div id=\"info-inst\">\n                            Press the icon in the top-left corner to display the\n                            menu.\n                          </div>\n                          <div id=\"info-inst\">\n                            Press <b>Choose file</b> to upload a <b>wav</b> or{\" \"}\n                            <b>mp3</b> audio file with speech. Press{\" \"}\n                            <b>Record</b> to record the speech in real-time.\n                          </div>\n                          <div id=\"info-inst\">\n                            Press <b>Upload</b> to send the speech recording to\n                            the server.\n                          </div>\n                          <div id=\"info-inst\">\n                            When the model is performing the computations on the\n                            server, a loading spinner is displayed. Wait until\n                            it disappears.\n                          </div>\n                          <div id=\"info-inst\">\n                            The <b>player</b> options in the bottom-left corner\n                            handle the animation. Change the intensity of the\n                            avatar's expression with the <b>slider</b>.\n                          </div>\n                          <button\n                            id=\"popup-close\"\n                            className=\"styled-button\"\n                            onClick={(e) => this.setState({ infoPopup: false })}\n                          >\n                            X\n                          </button>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                )}\n              </Transition>\n\n              <button\n                id=\"info-button\"\n                className=\"styled-button\"\n                onClick={(e) => this.setState({ infoPopup: true })}\n              >\n                &#9432;\n              </button>\n              {/* <button\n                id=\"logout-button\"\n                className=\"styled-button right\"\n                onClick={logout}\n              >\n                <i className=\"fa fa-power-off logout\"></i>\n              </button> */}\n\n              <div id=\"menu-icon\" onClick={this.showMenu}>\n                <div className=\"menu-bar\"></div>\n                <div className=\"menu-bar\"></div>\n                <div className=\"menu-bar\"></div>\n              </div>\n\n              <Transition timeout={300} in={this.state.menu}>\n                {(state) => (\n                  <div\n                    style={{\n                      ...defaultStyle,\n                      ...transitionStyles[state],\n                    }}\n                  >\n                    {this.state.menu && (\n                      <div id=\"main-container\">\n                        {/* <label class=\"switch\">\n                          <div id=\"dark\">Dark</div>\n                          <div className=\"span\"></div>\n                          <input\n                            type=\"checkbox\"\n                            onChange={this.themeHandler}\n                            ref={this.themeSlider}\n                          />\n                          <span class=\"slider round\"></span>\n                          <div>Light</div>\n                        </label> */}\n                        <label id=\"choose-file\" className=\"horizontal vert\">\n                          <div className=\"styled-button-file-input\">Choose file</div>\n                          <input\n                            id=\"choose-file\"\n                            type=\"file\"\n                            accept=\"audio/wav, audio/mp3\"\n                            onChange={this.handleFile}\n                            multiple={false}\n                          />\n                        </label>\n                        <div id=\"chosen-file\">{this.state.filename}</div>\n                        <button\n                          id=\"upload-button\"\n                          className=\"styled-button narrow\"\n                          onClick={this.sendFile}\n                        >\n                          Upload\n                        </button>\n                        <div className=\"bottom horizontal\">\n                          <button\n                            id=\"play\"\n                            className=\"player styled-button\"\n                            onClick={this.playAnimation}\n                          >\n                            Play\n                          </button>\n                          <button\n                            id=\"pause\"\n                            className=\"player styled-button\"\n                            onClick={this.pauseAnimation}\n                          >\n                            Pause\n                          </button>\n                          <button\n                            id=\"stop\"\n                            className=\"player styled-button\"\n                            onClick={this.stopAnimation}\n                          >\n                            Stop\n                          </button>\n                        </div>\n                        {/* <div className=\"recorder\">\n                          <AudioRecorder\n                            id=\"audio-recorder\"\n                            newRecording={this.handleRecording}\n                            theme={this.theme}\n                          />\n                        </div> */}\n                        {/* <div id=\"exp-int\">\n                          Expression <br /> intensity:\n                        </div>\n                        <div id=\"slider-value\">{this.state.sliderValue}</div>\n                        <input\n                          type=\"range\"\n                          id=\"slider\"\n                          min={0}\n                          max={1}\n                          value={this.state.sliderValue}\n                          step={0.05}\n                          onChange={this.handleSlider}\n                        />\n                        {!this.state.popup && (\n                          <progress\n                            id=\"progress\"\n                            max=\"1\"\n                            value={this.state.progress}\n                          ></progress>\n                        )} */}\n                      </div>\n                    )}\n                  </div>\n                )}\n              </Transition>\n              <Model\n                id=\"model\"\n                animationStatus={this.state.animationStatus}\n                visemes={this.state.visemes}\n                sliderValue={this.mapSliderValue(this.state.sliderValue)}\n                mounted={this.modelLoaded}\n                theme={this.theme}\n                setProgress={this.setProgress}\n                audio={this.audio}\n                stopAnimation={this.stopAnimation}\n              />\n            </div>\n          </div>\n        )}\n      </Transition>\n    );\n  }\n}\n\nexport default View;\n"]},"metadata":{},"sourceType":"module"}